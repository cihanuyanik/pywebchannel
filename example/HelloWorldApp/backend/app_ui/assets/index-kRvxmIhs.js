var k=Object.defineProperty;var x=(s,i,r)=>i in s?k(s,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[i]=r;var N=(s,i)=>()=>(i||s((i={exports:{}}).exports,i),i.exports);var p=(s,i,r)=>(x(s,typeof i!="symbol"?i+"":i,r),r);var E=N((U,j)=>{(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const e of a)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const e={};return a.integrity&&(e.integrity=a.integrity),a.referrerPolicy&&(e.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?e.credentials="include":a.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function t(a){if(a.ep)return;a.ep=!0;const e=r(a);fetch(a.href,e)}})();var _={signal:1,propertyUpdate:2,init:3,idle:4,debug:5,invokeMethod:6,connectToSignal:7,disconnectFromSignal:8,setProperty:9,response:10},w=function(s,i,r){if(typeof s!="object"||typeof s.send!="function"){console.error("The QWebChannel expects a transport object with a send function and onmessage callback property. Given is: transport: "+typeof s+", transport.send: "+typeof s.send);return}var t=this;this.transport=s;var a={Date:function(e){if(typeof e=="string"&&e.match(/^-?\d+-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d*)?([-+\u2212](\d{2}):(\d{2})|Z)?$/)){var o=new Date(e);if(!isNaN(o))return o}}};if(this.usedConverters=[],this.addConverter=function(e){typeof e=="string"?a.hasOwnProperty(e)?this.usedConverters.push(a[e]):console.error("Converter '"+e+"' not found"):typeof e=="function"?this.usedConverters.push(e):console.error("Invalid converter object type "+typeof e)},Array.isArray(r))for(const e of r)this.addConverter(e);else r!==void 0&&this.addConverter(r);this.send=function(e){typeof e!="string"&&(e=JSON.stringify(e)),t.transport.send(e)},this.transport.onmessage=function(e){var o=e.data;switch(typeof o=="string"&&(o=JSON.parse(o)),o.type){case _.signal:t.handleSignal(o);break;case _.response:t.handleResponse(o);break;case _.propertyUpdate:t.handlePropertyUpdate(o);break;default:console.error("invalid message received:",e.data);break}},this.execCallbacks={},this.execId=0,this.exec=function(e,o){if(!o){t.send(e);return}if(t.execId===Number.MAX_VALUE&&(t.execId=Number.MIN_VALUE),e.hasOwnProperty("id")){console.error("Cannot exec message with property id: "+JSON.stringify(e));return}e.id=t.execId++,t.execCallbacks[e.id]=o,t.send(e)},this.objects={},this.handleSignal=function(e){var o=t.objects[e.object];o?o.signalEmitted(e.signal,e.args):console.warn("Unhandled signal: "+e.object+"::"+e.signal)},this.handleResponse=function(e){if(!e.hasOwnProperty("id")){console.error("Invalid response message received: ",JSON.stringify(e));return}t.execCallbacks[e.id](e.data),delete t.execCallbacks[e.id]},this.handlePropertyUpdate=function(e){e.data.forEach(o=>{var y=t.objects[o.object];y?y.propertyUpdate(o.signals,o.properties):console.warn("Unhandled property update: "+o.object+"::"+o.signal)}),t.exec({type:_.idle})},this.debug=function(e){t.send({type:_.debug,data:e})},t.exec({type:_.init},function(e){for(const o of Object.keys(e))new v(o,e[o],t);for(const o of Object.keys(t.objects))t.objects[o].unwrapProperties();i&&i(t),t.exec({type:_.idle})})};function v(s,i,r){this.__id__=s,r.objects[s]=this,this.__objectSignals__={},this.__propertyCache__={};var t=this;this.unwrapQObject=function(n){for(const u of r.usedConverters){var d=u(n);if(d!==void 0)return d}if(n instanceof Array)return n.map(u=>t.unwrapQObject(u));if(!(n instanceof Object))return n;if(!n["__QObject*__"]||n.id===void 0){var f={};for(const u of Object.keys(n))f[u]=t.unwrapQObject(n[u]);return f}var c=n.id;if(r.objects[c])return r.objects[c];if(!n.data){console.error("Cannot unwrap unknown QObject "+c+" without data.");return}var l=new v(c,n.data,r);return l.destroyed.connect(function(){r.objects[c]===l&&(delete r.objects[c],Object.keys(l).forEach(u=>delete l[u]))}),l.unwrapProperties(),l},this.unwrapProperties=function(){for(const n of Object.keys(t.__propertyCache__))t.__propertyCache__[n]=t.unwrapQObject(t.__propertyCache__[n])};function a(n,d){var f=n[0],c=n[1];t[f]={connect:function(l){if(typeof l!="function"){console.error("Bad callback given to connect to signal "+f);return}t.__objectSignals__[c]=t.__objectSignals__[c]||[],t.__objectSignals__[c].push(l),!d&&(f==="destroyed"||f==="destroyed()"||f==="destroyed(QObject*)"||t.__objectSignals__[c].length==1&&r.exec({type:_.connectToSignal,object:t.__id__,signal:c}))},disconnect:function(l){if(typeof l!="function"){console.error("Bad callback given to disconnect from signal "+f);return}t.__objectSignals__[c]=(t.__objectSignals__[c]||[]).filter(function(u){return u!=l}),!d&&t.__objectSignals__[c].length===0&&r.exec({type:_.disconnectFromSignal,object:t.__id__,signal:c})}}}function e(n,d){var f=t.__objectSignals__[n];f&&f.forEach(function(c){c.apply(c,d)})}this.propertyUpdate=function(n,d){for(const c of Object.keys(d)){var f=d[c];t.__propertyCache__[c]=this.unwrapQObject(f)}for(const c of Object.keys(n))e(c,n[c])},this.signalEmitted=function(n,d){e(n,this.unwrapQObject(d))};function o(n){var d=n[0],f=n[1],c=d[d.length-1]===")"?f:d;t[d]=function(){for(var l=[],u=0;u<arguments.length;++u)l.push(arguments[u]);return new Promise((O,S)=>{r.exec({type:_.invokeMethod,object:t.__id__,method:c,args:l},function(m){if(m!==void 0){var C=t.unwrapQObject(m);O(C)}else S("Unknown error: Possible communication lost")})})}}function y(n){var d=n[0],f=n[1],c=n[2];t.__propertyCache__[d]=n[3],c&&(c[0]===1&&(c[0]=f+"Changed"),a(c,!0)),Object.defineProperty(t,f,{configurable:!0,get:function(){var l=t.__propertyCache__[d];return l===void 0&&console.warn('Undefined value in property cache for property "'+f+'" in object '+t.__id__),l},set:function(l){if(l===void 0){console.warn("Property setter for "+f+" called with undefined value!");return}t.__propertyCache__[d]=l;var u=l;r.exec({type:_.setProperty,object:t.__id__,property:d,value:u})}})}i.methods.forEach(o),i.properties.forEach(y),i.signals.forEach(function(n){a(n,!1)}),Object.assign(t,i.enums)}v.prototype.toJSON=function(){return this.__id__===void 0?{}:{id:this.__id__,"__QObject*__":!0}};typeof j=="object"&&(j.exports={QWebChannel:w});class P{constructor(i,r){p(this,"_backend_socket_url");p(this,"_serviceName");p(this,"_ws");p(this,"channel");this._backend_socket_url=i,this._serviceName=r,this._ws=null}isConnected(){return this._ws&&this._ws.readyState===WebSocket.OPEN}async connect(){return new Promise(async(i,r)=>{if(this.isConnected()){i(!0);return}this._ws=new WebSocket(this._backend_socket_url),this._ws.onerror=()=>r(`Error connecting to ${this._serviceName}`),this._ws.onclose=()=>r(`${this._serviceName} connection closed`),this._ws.onopen=t=>new w(this._ws,async a=>{this.channel=a,await this.onChannelReady(a),i(t)})})}async disconnect(){return new Promise((i,r)=>{this._ws.close(1e3),this._ws.onclose=t=>i(t),this._ws.onerror=t=>r(t)})}}class Q extends P{constructor(){super("ws://localhost:9000","Command Transfer Service");p(this,"HelloWorldController")}async onChannelReady(r){this.HelloWorldController=r.objects.HelloWorldController}}const g=new Q;g.connect().then(()=>{g.isConnected()&&console.log("Successfully connected to backend")}).catch(s=>{console.log(s)});document.querySelector("#app").innerHTML=`
  <div> 
    <input id="input">
    <button id="button">Say Hi</button>
  </div>
`;const h=document.querySelector("#input"),b=document.querySelector("#button");b==null||b.addEventListener("click",async()=>{console.log(h==null?void 0:h.value);const s=await g.HelloWorldController.sayHello(h==null?void 0:h.value);if(s.error){console.log(s.error);return}if(s.success){alert(s.success);return}if(s.data){alert(JSON.stringify(s.data));return}})});export default E();
